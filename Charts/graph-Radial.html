<html>

<head>


</head>

<body>
    <!-- messageDisplay comes from the thunkable app -->
    <p style="text-align: center;"><span id="messageDisplay"></span>
        <div id="chart"></div>
    </p>
    <script>
        var chart = c3.generate({
            data: {
                columns: [
                    ['data1', 91.4],
                ],
                type: 'gauge',
                onclick: function (d, i) { console.log("onclick", d, i); },
                onmouseover: function (d, i) { console.log("onmouseover", d, i); },
                onmouseout: function (d, i) { console.log("onmouseout", d, i); }
            },
            gauge: {
                label: {
                    format: function (value, ratio) {
                        return value;
                    },
                    show: false // to turn off the min/max labels.
                },
                min: 0, // 0 is default, //can handle negative min e.g. vacuum / voltage / current flow / rate of change
                max: 100, // 100 is default
                units: ' %',
                width: 39 // for adjusting arc thickness
            },
            color: {
                pattern: ['#FF0000', '#F97600', '#F6C600', '#60B044'], // the three color levels for the percentage values.
                threshold: {
                    //            unit: 'value', // percentage is default
                    //            max: 200, // 100 is default
                    values: [30, 60, 90, 100]
                }
            },
            size: {
                height: 180
            }
        });


        // when we get a message from the app, display it on the page
        // message should be a JSON string of a list of numbers
        //I think there is a way to change the legend titles. I dont want the trend title to show at all. EVER
        ThunkableWebviewerExtension.receiveMessage(function (message) {
            try {

                var messageList = JSON.parse(message);
                var titleName = messageList.title

                chart.load({
                    columns: [
                        ['data1'].concat(messageList.data),
                    ],
                    names: {
                        data1: titleName
                    }
                });
            } catch (e) {
                console.error("An error occurred. Message probably wasn't a JSON string of an array of numbers");
            }
        });
    </script>
</body>

</html>
